<!doctype html>
<html class="theme-next ">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="h7BaHlqi6VjlciSt0RF-KHgIXZcGfx3L3gyQ9qfx_ek" />










  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.4.5.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="wuxu, Golang, C, CPP, CS, PHP, " />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.4.5.2" />






<meta name="description" content="Wu Xu的个人博客">
<meta property="og:type" content="website">
<meta property="og:title" content="Wu Xu">
<meta property="og:url" content="http://blog.wuxu92.com/page/9/index.html">
<meta property="og:site_name" content="Wu Xu">
<meta property="og:description" content="Wu Xu的个人博客">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Wu Xu">
<meta name="twitter:description" content="Wu Xu的个人博客">



<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: '',
    sidebar: 'hide',
    motion: false
  };
</script>

  <title> Wu Xu </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->
  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-72131273-1', 'auto');
  ga('send', 'pageview');
</script>





  <div class="container one-column 
   page-home 
">
    <div class="headband"></div>
    <div class="bottomband"></div> <!-- add by wuxu -->
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Wu Xu</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">关注C、Go、C++、JavaScript和Rust</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />
            
            关于
          </a>
        </li>
      

      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content">
          
  <section id="posts" class="posts-expand">

    

    
    

    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/intro-of-cloudsim/" itemprop="url">
                  Cloudsim 云计算仿真系统介绍
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2015-12-16T12:34:50+08:00" content="2015-12-16">
              2015-12-16
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/simulation/" itemprop="url" rel="index">
                    <span itemprop="name">simulation</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>bw: bandwidth<br>cloudlet<br>CIS: cloud information service,执行资源的分配与注册， CloudSim 初始化时会生成该类的实例，不需要自己处理<br>PE: Processing Element, CPU unit<br>vm: virtual machine, runs inside a Host, sharing hostList with other VMs. process cloudlets.process according to CloudletScheduler’s(timeShared, spaceShared) defined policy. VmSchedulerTimeShared is property of Host.<br>datacenterBroker: 代理仁，代表用户执行操作，对用户隐藏虚拟机管理（创建，提交任务到虚拟机，虚拟机销毁）。<br>Event: </p>
<p>可以有多个datacenter， 一个datacenter有多个host，一个host有多个PE，</p>
<p>一个仿真流程</p>
<ol>
<li>设置用户数量（broker count)</li>
<li>设定通用的变量</li>
<li>创建CIS（自动创建）</li>
<li>创建Datacenter：包括 host + characteristics(Pe, Ram, Bw, price)</li>
<li>创建DatacenterBroker</li>
<li>创建Vm instances</li>
<li>提交Vm　list 到 broker</li>
<li>创建 Cloudlet(tasks) List</li>
<li>提交(submit) Cloudlet lists到broker</li>
<li>start simulation</li>
<li>stop simulation</li>
<li>输出仿真的状态</li>
</ol>
<h2 id="CloudSim-Events-the-heartbeat-of-simulation"><a href="#CloudSim-Events-the-heartbeat-of-simulation" class="headerlink" title="CloudSim Events the heartbeat of simulation"></a>CloudSim Events the heartbeat of simulation</h2><p>非常重要的类： SimEvent</p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/apue-files-and-dirs/" itemprop="url">
                  APUE：文件和目录
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2015-12-15T12:34:50+08:00" content="2015-12-15">
              2015-12-15
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Programming/" itemprop="url" rel="index">
                    <span itemprop="name">Programming</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <p><img src="/images/linux-logo.png" alt=""><br>前面已近有一篇系统级IO，那是 CSAPP 中的一章，讲了Unix IO的内容，这一次是Unix环境高级编程的一章，也是讲Unix/Linux下的文件IO，可能这里讲编程的内容多一些。</p>
<p>我们知道通过 low level 的 open, creat 方法调用可以获得一个 file description ,它是一个整数，对应到进程文件描述符表的一项，使用这个整数就可以标识这个打开的文件。</p>
<h2 id="文件信息"><a href="#文件信息" class="headerlink" title="文件信息"></a>文件信息</h2><p>对于一个打开的文件的 fd， 我们已经知道有一个 <code>stat</code> 函数可以获得该文件的信息，其实有另外好几个类似的函数（在64位系统还是有stat64的一套函数），其函数声明如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#include &lt;sys/stat.h&gt;</span><br><span class="line">int stat(const char *restrict pathname, struct stat *restrict buf);</span><br><span class="line">int fstat(int fd, struct stat *buf);</span><br><span class="line">int lstat(const char *restrict pathname, struct stat *restrict buf);</span><br><span class="line">int fstatat(int fd, const char *restrict pathname, struct stat *restrict buf, int flag);</span><br></pre></td></tr></table></figure>
<p>它们的作用都是获得某个文件的相关信息，文件信息被保存在一个结构体中，上面的函数调用会填充这个函数体的成员字段。stat和fstat比较好理解，只是第一个参数不同（不考虑参数的修饰符），stat使用一个文件名做参数，fstat使用一个fd做参数，实际的效果是一样的，不过stat的buf参数使用了restrict修饰符，这个修饰符在之前的文章中已经解释过了，它提示编译器保证该指针指向的对象不被当前指针以外的指针修改。<br>
          <div class="post-more-link text-center">
            <a class="btn" href="/apue-files-and-dirs/" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/array-and-pointer/" itemprop="url">
                  C数组和指针
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2015-12-14T12:34:50+08:00" content="2015-12-14">
              2015-12-14
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Programming/" itemprop="url" rel="index">
                    <span itemprop="name">Programming</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <p><img src="/images/clang.gif" alt=""><br>尽管现在很多的高级语言，脚本语言提供了非常非常方便实用的数组，队列(list)，字典（map）等数据结构，但是理解C语言的数组和指针是掌握这些高级数据结构的基础。即使不经常写底层的数组，也应该熟练掌握。</p>
<h2 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h2><p>数组的初始化比较简单不罗嗦了，这里介绍一下数组的指定项目初始化方法，这是c99添加的特性，个人觉得很有意思。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// 普通的初始化方法</span><br><span class="line">int year[6] = &#123;31, 28, 31, 30, 31, 30&#125;;</span><br><span class="line">// 可以在初始化时指定要初始化的项及其值如：</span><br><span class="line">int year[6] = &#123; [1] = 28, [3] = 30, 31, 30, [1] = 29&#125;;</span><br><span class="line">// 初始化结果为： [0, 29, 0, 30, 31, 30]</span><br></pre></td></tr></table></figure>
<p>看起来还算好理解，就是指定下标对其赋值。某个指定赋值后的为指定项目用来对后续的元素初始化，未初始化的项会初始化为0（只要对数组进行了初始化就会把剩余的部分初始化为0，这是一般行为）。甚至可以对一项多次指定赋值，以最后一次为准。</p>
<blockquote>
<p>再提一次，花括号列表的形式只能用于初始化，不能用于对数组赋值。</p>
</blockquote>
<p>对数组指针使用sizeof的时候会计算到第一个 <code>\0</code> 处，常用 <code>sizeof arr / sizeof arr[0]</code> 计算数组的大小。但是实际上这样做可能会导致问题。<br>
          <div class="post-more-link text-center">
            <a class="btn" href="/array-and-pointer/" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/hai-xu-yao-xue-xi-yi-ge/" itemprop="url">
                  为什么还要学习一个
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2015-12-14T12:34:50+08:00" content="2015-12-14">
              2015-12-14
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/life/" itemprop="url" rel="index">
                    <span itemprop="name">life</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <blockquote>
<p>人啊，就还得要多学习一个，要不然想的东西啊，总是 too simple。<br>–来自长者的教诲</p>
</blockquote>
<p>从实习离职回学校“搞论文”已经快三个月了。实在的，论文没怎么搞，没搞出什么东西，已经对科研非常的没兴趣了，不适合做科研。不过这三个月看些书，就觉得啊，还是要学习一个，要不然搞得那些东西啊，一点都不excited，都 too simple，跑的一点都不快，没什么搞头。</p>
<p>在学校做工程的人多容易飘飘然，这是我的感受。虽然我见的一点也不多，但是我作为一个年轻人，我还是要说一个，现在做项目的啊，都太low。现在在学校做项目的主要是几个：老师的项目，工程性的项目，老师和外面公司，机构谈好，回来交给学生做，然后老师基本不管；学生自己的项目，几个人组一个团队，拉一些活自己写，能力好的能做的不错，听说不少都不能按时完成。</p>
<p>做项目的好处是能实践一些东西，现在做创业的那么多，随便加入一个创业团队，从后台导前台，从开发到运维到推广都能体验一番，但是呢，现在做创业的都太浮躁了，看起来从前到后，从低到高全栈了一把，实际上，现在99%的创业团队里，技术都不是重点，用php,python,ruby搞个模板一趟的网站出来就可以搞个大新闻了。这种看起来厉害的全栈，真的非常危险，尤其是对我们这样的学生来说。</p>
<p>当然这只是我自己的感觉。曾经我也认为自己全栈的一逼，虽然我CSS渣的可以，但是前端的人都偶尔找我调CSS；虽然JS一直没弄懂闭包，不过真正能写JS的人实在很少，我也能顶一下；后台那些框架，哪个我没用过（胡），Restful API， MVC，MVVC，一套一套的。这些名词堆砌的多了，就自己真的都会相信自己是全栈了。</p>
<p>但是真正想想自己做过的那些东西，有什么技术吗？所谓的技术，其实就是你知不知道这个东西，有没有这个思路，知道这个东西的名字，查查资料，翻翻教程，一般的一周就能上手了。现在所谓的互联网创业，大多数都是这样的技术支撑着，就能拿大笔投资，真是想不明白，这样的都能技术创业，要是还都成功了，简直没天理了。</p>
<p>那应该学习一个，要学什么呢？我觉得还是计算机理论的基础。但是又要结合工程的实际，不是科研的那种；组成原理，计算机网络，编译，操作系统，这些才应该是985计算机专业学生的内力，才是和其他人比较时有优势的地方。当然主流的语言，框架，数据库技术都很重要，这就需要花更多的时间去学习，毕竟虽然说它们比较简单，但是要掌握真的还是要花费时间精力的。</p>
<p>不过这中的调和又很矛盾，我自己是理论基础学的不好的，所以我认为其他人应该理论都学的比我好（什么逻辑），但是我看的有的人的Linux水平，实在不能说是一个计算机专业毕业的学生。虽然Linux并不是必须要掌握的技术，但是技能树上没有这一枝，实在太可惜了。</p>
<p>那些网上卖水果的，卖各种乱七八糟的P2P行业，忽悠了好几年，实在没看出来他们创造的价值在哪里，根本没有解决什么问题。绝大部分的P2P就是忽悠，尤其是P2P理财，水分泡沫太大了，基本全是泡沫所以看起来很好。</p>
<p>未完</p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/linux-shortcuts-and-commands/" itemprop="url">
                  Linux Shortcuts And Commands
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2015-12-12T12:34:50+08:00" content="2015-12-12">
              2015-12-12
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/server/" itemprop="url" rel="index">
                    <span itemprop="name">server</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <p><img src="/images/linux-logo.png" alt=""></p>
<p>来源： <a href="http://www.unixguide.net/linux/linuxshortcuts.shtml" target="_blank" rel="noopener">http://www.unixguide.net/Linux/linuxshortcuts.shtml</a> 个人觉得非常好的一个Linux入门资料。待我慢慢翻译整理出来。</p>
<blockquote>
<p>前面的部分很值得看看，后面的很多管理工具都已经过时了，看不看影响不大了。</p>
</blockquote>
<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>This is a practical selection of the commands we use most often. Press <tab> to see the listing of all available command (on your PATH). On my small home system, it says there are 2595 executables on my PATH.  Many of these “commands” can be accessed from your favourite GUI front-end (probably KDE or Gnome) by clicking on the right menu or button. They can all be run from the command line.  Programs that require GUI have to be run from a terminal opened under a GUI.</tab></p>
<p>图例: </p>
<ul>
<li><code>&lt;&gt;</code> = 键盘上的单个特殊按键或者功能键. 比如用 <ctrl> 表示 “control” 键. </ctrl></li>
<li><em>italic</em> = 斜体字用于文件名，或者需要你自己替换的变量. </li>
<li>fixed width = 等宽字体表示Linux命令和文件.</li>
</ul>
<p>对Unix新手的提示:<br>
          <div class="post-more-link text-center">
            <a class="btn" href="/linux-shortcuts-and-commands/" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/c-bits/" itemprop="url">
                  位运算
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2015-12-12T12:34:50+08:00" content="2015-12-12">
              2015-12-12
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Programming/" itemprop="url" rel="index">
                    <span itemprop="name">Programming</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p><img src="/images/clang.gif" alt=""><br>C可以对变量的个别位进行操作，这在流行的其他高级语言中不太常见了，尤其是脚本语言很少有这样的能力了。位操作最常见的情景是设备控制的驱动程序，每一位都有特定的含义；数据的压缩与解压缩，数据加密解密等等。</p>
<h2 id="基础：二进制数、位、字节"><a href="#基础：二进制数、位、字节" class="headerlink" title="基础：二进制数、位、字节"></a>基础：二进制数、位、字节</h2><p>这部分是计算机理论基础，只提一个有意思的点：一个字节通常包括8个位，不过C使用术语字节（byte)表示用于存放系统字符集的空间大小，所以一个C字节可能为8，9，16位或者其他的值。然而描述存储器芯片和数据传输率时使用的字节就是指8位字节。</p>
<p>关于字符编码的原码，反码，补码的内容，不再赘述。</p>
<h2 id="位运算符"><a href="#位运算符" class="headerlink" title="位运算符"></a>位运算符</h2><p>C提供位的<strong>逻辑运算符</strong>和<strong>移位运算符</strong>。</p>
<h3 id="位逻辑运算符"><a href="#位逻辑运算符" class="headerlink" title="位逻辑运算符"></a>位逻辑运算符</h3><p>4个位运算符用于整型数据，位逻辑运算符与常规的逻辑运算符（&amp;&amp;, ||, ！）不一样，使用时不要把它们混淆了。常规的逻辑运算符是对整个操作数进行的，而位逻辑运算是针对数的某一位操作，而不影响其他位。</p>
<ul>
<li>取二进制反码，或者按位取反: <code>~</code> 将一个数的二进制表示形式按位取反。注意，~是一个操作符， <code>~val</code> 并不改变val的值，就像 <code>3*val</code> 不会改变val保存的值，该操作会返回一个操作的结果，用于赋值语句的右边。</li>
<li>位与 <code>&amp;</code> 两个操作数按位与产生一个新值。两个操作数对应位都为1时，结果的那一位也为1，否则为0.</li>
<li>位或 <code>|</code> 和 &amp;很像</li>
<li>按位异或 <code>^</code> 对每一个位，如果操作数中的对应位有且只有一个为1，结果对应位也为1，都则结果对应位为0</li>
</ul>
<p>这四个操作符和 数值运算(+, -, *, /)一样可以与赋值符号（=）结合成一个赋值运算符（&amp;=, |=, ^=）。其中取反常写为 <code>val = ~val;</code>。</p>
<h3 id="掩码、打开位"><a href="#掩码、打开位" class="headerlink" title="掩码、打开位"></a>掩码、打开位</h3><p>掩码常用在如子网掩码的名称中，掩码是某些位设为1而某些位设为0的位组合。使用掩码与<code>&amp;</code>操作符的目的是将特定位之外的所有位都设置为0.</p>
<p>与使用掩码相对的是打开某个为，使用 <code>|</code> 操作符与掩码将某些位保持不变而使某些位都设置位1。</p>
<p>其他还有关闭位（ f &amp;= ~mask），转置位（f ^= mask）都是很常用的。</p>
<h3 id="查看某一位的值"><a href="#查看某一位的值" class="headerlink" title="查看某一位的值"></a>查看某一位的值</h3><p>用 &amp; 实现查看变量某一个位的值.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">int i = 123;</span><br><span class="line">int mask = 0b01000000;		// 01000000</span><br><span class="line">if ( (i &amp; mask ) == mask)</span><br><span class="line">	puts(&quot;bit 6 of i is 1&quot;);</span><br></pre></td></tr></table></figure>
<p>这种方法中，为避免信息漏过边界，位掩码至少应该与其所屏蔽的值具有相同的宽度。</p>
<h2 id="移位运算"><a href="#移位运算" class="headerlink" title="移位运算"></a>移位运算</h2><p>移位运算包括左移和右移两种。</p>
<p>左移运算 <code>&lt;&lt;</code> 将左侧操作数的值的每一位都向左移动，移动的位数由右侧操作数指定。空出的位用 0 填充，并且丢弃移出做操作数末端的未。移位操作返回一个新值而不改变其操作数。如 <code>i &lt;&lt; 2</code> 返回i左移2位的结果，i的值不变。</p>
<p>右移运算 <code>&gt;&gt;</code> 将做操作数的每位向右移动。丢弃移出左侧操作数右端的位。对于无符号类型（unsigned），使用0填充左端空出的位，对于有符号数，结果依赖于机器，可能用0填充，可能用符号位填充（常用符号位填充）。</p>
<p>移位运算是高校的对2的幂的乘法和除法，在编译器的优化中常用移位运算和加法运算组合来优化乘法运算，比如 <code>i*33</code> 可以被优化为 <code>i &lt;&lt; 5 + i</code> 这样子。这些优化取决于编译器实现，对程序员是透明的。</p>
<p>移位运算对于按位存储数据的变量很有用有用，比如颜色常保存为 <code>0xff00ff00</code> 这样子，使用移位与 <code>&amp;</code> 操作符可以方便的取得 rgba 对应的数值。</p>
<h2 id="位字段"><a href="#位字段" class="headerlink" title="位字段"></a>位字段</h2><p>位字段在之前的一片介绍链接的部分，ELF的结构体中使用过。这种技术在网络协议中也经常会使用。</p>
<p>位字段是一个singed int 或者 unsigned int 中一组相邻的位。位字段<strong>由一个结构声明建立</strong>，该结构声明为每一个字段提供<strong>标签</strong>，并决定<strong>字段的宽度</strong>。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">struct &#123;</span><br><span class="line">	unsigned int autfd: 1;</span><br><span class="line">	unsigned int bldfc: 1;</span><br><span class="line">	unsigned int undln: 1;</span><br><span class="line">	unsigned int itals: 1;</span><br><span class="line">&#125; prnt</span><br><span class="line"></span><br><span class="line">prnt.autfd = 1;</span><br><span class="line">prnt.itals = 0;</span><br></pre></td></tr></table></figure>
<p>该定义使prnt包含4个1位的字段，可以像使用普通结构成员运算符一样将值赋给单独的字段。变量prnt被存储在一个int大小的存储单元中，且只有4位被使用。</p>
<p>带有位字段的结构允许在单个单元中存储多项设置。但是要确保设置的值没有超出字段的容量。</p>
<p>如果声明的结构中总的字段数超过了一个unsigned  int 大小，那么将会使用下一个unsigned int存储位置。<strong>不允许</strong>一个字段跨越两个存储位置的边界，如果有这种情况编译器将自动地移位字段定义，使字段按照unsigned int边界对齐。这样会在前一个存储位置留下一个未命名的洞。</p>
<p>可以使用<strong>未命名字段填充未命名的洞</strong>。使用一个宽度为0的未命名字段迫使下一个字段与下一个存储位置对齐。也就是说位字段结构成员的大小没有什么限制，只要注意边界对齐就可以了。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">struct &#123;</span><br><span class="line">	unsigned int field1	: 3;</span><br><span class="line">	unsigned int 		: 1;	// leave a hole</span><br><span class="line">	unsigned int field2	: 3;</span><br><span class="line">	unsigned int		: 0;	// hole for align</span><br><span class="line">	unsigned int field	: 5;</span><br><span class="line">&#125; staff;</span><br></pre></td></tr></table></figure>
<p>一个可能的问题是字段在int中的顺序依赖于机器实现，有的机器上从左到右存储，在另一些机器则是从右向左，所以位字段往往难以移植，典型地，把他们用于不可移植的用途，例如按照某个特定硬件设备所使用的确切格式来存放数据。</p>
<p>位字段和位运算符是对于同类编程问题的两种可选择的方法，<strong>可以使用其中任何一种</strong>，通常来说位字段的方法比较好理解，使用也更加方便。</p>
<p>完？</p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/c-standard-file-io/" itemprop="url">
                  C 文件IO
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2015-12-11T12:34:50+08:00" content="2015-12-11">
              2015-12-11
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Programming/" itemprop="url" rel="index">
                    <span itemprop="name">Programming</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p><img src="/images/clang.gif" alt=""></p>
<h2 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h2><p>一个文件可以理解为磁盘上的一段命名的存储区。对于操作系统来说，文件更加复杂，比如大文件可能存储在分散的区段中，或者还会包含一些使操作系统确定文件类型的附加数据等。但是对于C程序员来说不需要考虑底层文件系统的实现，C将文件看出是连续的字节序列，每一个字节都可以单独地存取。 ANSI C提供了文件的两种试图：文本视图和二进制视图。</p>
<p>文本试图和二进制试图是指使用C打开文件的模式，与Windows中的文本文件和二进制文件是两个不同的概念（对C程序来说文本文件和二进制文件没有区别）。使用文本模式打开文件时，会将本地环境表示法映射为C试图，比如 windows 和 Linux有不同的换行模式，但是是用文本模式打开文件时，这两个换行方式都会被映射到 <code>\n</code> ，同样一个C中以 <code>\n</code> 换行的字符串写到文本模式打开的文件时，会自动转换到 <code>\r\n</code> 或者 macintosh 的 <code>\r</code>。而使用二进制模式打开文件则不会有这样的映射。通常使用文本模式处理二进制文件会效果很糟糕，但是也是可以使用的。</p>
<p>标准输入、输出、错误流是三个特殊的文件，这个已经提到过多次了，它们的fd分贝是0,1,2。</p>
<h2 id="标准IO"><a href="#标准IO" class="headerlink" title="标准IO"></a>标准IO</h2><p>之前提到过一篇<a href="http://wuxu92.github.io/system-level-io" target="_blank" rel="noopener">系统级IO</a>。系统级IO（Unix IO)一般称为低级IO(low level io)，使用操作系统提供的基本IO服务，标准IO则是标准C提供的保准所有操作系统都可用的IO模型，ANSI C建立的标准IO模型具有很好的可移植性，我们讨论的标准IO就是它。</p>
<p>除了可以执行之外，标准IO相对于系统级IO还有两个优势：</p>
<ol>
<li>标准IO包含了很多专用的函数，可以方便地处理不同的IO问题。</li>
<li>对于输入和输出进行了缓冲，也就是可以大块地转移信息，而不是每次一个字节地转移。</li>
</ol>
<p>对于标准IO的学习主要就是一些标准IO函数的学习。这些函数本身不是很复杂，只需要大概记住它们的函数声明就可以使用了。这里不一一列举了，写一些比较常用的。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">// 打开一个文件，返回一个新的流,</span><br><span class="line">FILE * fopen(const char * restrict __filename, const char * resttrict __modes); </span><br><span class="line">// 打开一个文件，替换一个已存在的流</span><br><span class="line">FILE *reopen(const char * restrict __filename, const char * restrict __modes, FILE * restrict __stream)</span><br><span class="line">`</span><br></pre></td></tr></table></figure>
<p>第二个参数的打开模式使用一个字符串表示，常用<code>r</code>, <code>w</code>, <code>a</code>, <code>r+</code>, <code>w+</code>, <code>a+</code>,注意<strong>使用了w的模式都会删除原有文件的内容</strong>。这几个模式都可以再加一个 b 表示使用二进制模式而非文本模式打开文件。不过对于Unix和Linux这样只有一种文件类型的系统，带b和不带b的模式是相同的。</p>
<p>可以看出<code>fopen</code>和系统级IO的<code>open</code>返回的不一样，<code>fopen</code>返回一个方便操作的文件指针fp，而<code>open</code>是返回一个int类型的fd。指针fp指向一个关于文件信息的数据包，而不是指向实际的文件。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">int fgetc(FILE *);</span><br><span class="line">int getc(FILE *);</span><br><span class="line">int fputc(int, FILE *);</span><br><span class="line"></span><br><span class="line">char * fgets(char * restrict __s, int __n, FILE * restrict __stream);</span><br><span class="line">int fputs(const char * restrict, FILE * restrict);</span><br><span class="line"></span><br><span class="line">int fclose(FILE *);	// 关闭成功返回0</span><br><span class="line">int fflush(FILE *);	// 刷新文件</span><br><span class="line"></span><br><span class="line">// code snippet</span><br><span class="line">while ((ch = getc(fp) != EOF) &#123;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>fgetc 和 getc 的主要区别是 getc是使用宏实现的，而fgetc是一个函数，这意味着一些区别：</p>
<ol>
<li>getc的参数不能是一个有副作用的表达式（虽然没有语法错误，但是会很危险）</li>
<li>可以获得<code>fgetc</code>的地址（函数指针）</li>
<li>理论上来说，<code>getc</code> 速度更快，对于大量使用的情况，推荐使用 <code>getc</code></li>
</ol>
<p>文件的格式化输入输出：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">int fprintf(FILE * restrict __stream, const char * restrict __format, ...);</span><br><span class="line">int fscanf(FILE * restrict __stream, const char * restrict __format, ...);</span><br></pre></td></tr></table></figure>
<p>文件指针操作：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">int fseek(FILE * __stream, long int __off, int __whence);	// 设置位置指针为指定的值</span><br><span class="line">long int ftell(FILE * __stream);		// 获取当前文件位置</span><br><span class="line"></span><br><span class="line">int fgetpos(FILE * restrict __stream, fpos_t * restrict __pos);</span><br><span class="line">int fsetpos(FILE * __stream, const fpos_t * __pos);</span><br></pre></td></tr></table></figure>
<p>上面的<code>fseek</code>设定指针的位置是很常见的，其中第二的参数 offset 是一个可正可负可为零（为0用于测试该流是否允许设置指针位置）的long int 类型，第三个参数说明offset 的起始点。 ANSI 中定义了如下起始点常量：</p>
<ul>
<li>SEEK_SET 。 文件开始</li>
<li>SEEK_CUR 。 当前指针</li>
<li>SEEK_END 。 文件结尾</li>
</ul>
<p>结合起始点与偏移量可以方便的设置到任意的文件位置。</p>
<p>fgetpos 和 fsetpos 使用一个 <code>fpos_t</code> 类型的指针作为设置值，可以用于更大的文件（超过long int范围长度的文件）。</p>
<h2 id="标准IO内幕"><a href="#标准IO内幕" class="headerlink" title="标准IO内幕"></a>标准IO内幕</h2><p>哈哈哈</p>
<h2 id="其他标准IO函数"><a href="#其他标准IO函数" class="headerlink" title="其他标准IO函数"></a>其他标准IO函数</h2><p>列出来如下：</p>
<ul>
<li><code>int ungetc(int c, FILE *fp)</code> 将指定字符c放回输入流</li>
<li><code>int feof(FILE *fp)</code> 判断是否到达文件结尾</li>
<li><code>int ferror(FILE *fp)</code> 测试错误指示器</li>
<li><code>void clearerr(FILE *)</code> 清楚文件结尾和错误指示器</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">int setvbuf(FILE * fp, char * buf, int mode, size_t size);</span><br><span class="line">size_t fread(const void * ptr, size_t size, size_t nmemb, FILE * fp);</span><br><span class="line">size_t fwrite(void *ptr, size_t size, size_t nmemb, FILE * fp);</span><br></pre></td></tr></table></figure>
<p>servbuf可以建立一个供标准IO函数使用的替换缓冲区。（cpp 368）</p>
<p>完</p>
<p>参考：</p>
<ul>
<li><a href="http://stackoverflow.com/questions/18480982/getc-vs-fgetc-what-are-the-major-differences" target="_blank" rel="noopener">http://stackoverflow.com/questions/18480982/getc-vs-fgetc-what-are-the-major-differences</a></li>
<li>C primer Plus</li>
<li>CSAPP</li>
</ul>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/stdargs.h-no-such-file-or-directory/" itemprop="url">
                  fatal error： stdarg.h： No such file or directory
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2015-12-10T12:34:50+08:00" content="2015-12-10">
              2015-12-10
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Programming/" itemprop="url" rel="index">
                    <span itemprop="name">Programming</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>今天学习C的库函数，到可变参数部分，使用gcc编译一个简单的程序发现编译报错，代码如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#include &lt;stdargs.h&gt;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">double sum(int lim, ...);</span><br><span class="line">int main(void) &#123;</span><br><span class="line">    double s, t;</span><br><span class="line">    s = sum(3, 1.0, 2.02, 3.123);</span><br><span class="line">    t = sum(8, 2.9, 9.1, 2.2, 4.1, 99.2, 43.2, 54.1, 9.0);</span><br><span class="line"></span><br><span class="line">    printf(&quot;sum of s is %g\nsum of t is %g\n&quot;, s, t);</span><br><span class="line">&#125;</span><br><span class="line">double sum(int lim, ...) &#123;</span><br><span class="line">    va_list ap;</span><br><span class="line">    double sum = 0;</span><br><span class="line">    int i;</span><br><span class="line">    va_start(ap, lim);</span><br><span class="line">    for (i=0; i&lt;lim; i++)</span><br><span class="line">        sum += va_arg(ap, double);</span><br><span class="line">    va_end(ap);</span><br><span class="line">    return sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>错误如下：<code>fatal error: stdarg.h: No such file or directory</code>，头文件不存在，很奇怪，去找了一下 /usr/include 目录确实没有这个文件，<del>用find查找竟然也没发现这个文件，难道系统没有这个文件？不可能的啊。</del>(是find 的时候打错名字了。。。真是见鬼，闹腾到今天才发现）</p>
<p>实际上系统是有这个文件的，不过不在 include 目录下，在 <code>/usr/lib/gcc/x86_64-redhat-Linux/4.8.2/include/</code> 这个目录下是有这个文件的。这是我的CentOS下的路径，可能其他发行版的路径名略有不同。</p>
<p>为了让gcc找到这个头文件，我们可以拷贝一份到 <code>/usr/include</code> 下，但是更好的方法是做一个软连接：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo ln -s /usr/lib/gcc/x86_64-redhat-Linux/4.8.2/include/stdargs.h /usr/include/stdargs.h</span><br></pre></td></tr></table></figure>
<p>在编译就没问题了。</p>
<p>软连接在这种情况下很有用的工具，很多编译器找不到共享目标啊，找不到头文件啊，都给个软连接可以解决。</p>
<p>== added</p>
<p>前面讲到的find 查找文件，因为centos 7没有了locate命令（locate真的很方便，只是要维护一个db确实比较不讨人喜欢就被砍了吧），查找文件都是用find，常用的方法如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">find -L /usr -name &quot;*file-to-find*&quot; -type f</span><br></pre></td></tr></table></figure>
<p>-L 表示 follow symbol link， -type f表示输出文件，不输出目录，也可以 -type d 只输出目录。</p>
<p>查找的名字，可以用双引号括起来，加通配符。</p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/c-preprocessor/" itemprop="url">
                  预处理器
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2015-12-09T12:34:50+08:00" content="2015-12-09">
              2015-12-09
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Programming/" itemprop="url" rel="index">
                    <span itemprop="name">Programming</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <p><img src="/images/clang.gif" alt=""><br>C语言以C关键字、表达式、语句，以及这些元素的使用规则为基础。ANSI C标准不仅描述了C语言，还描述了C预处理器的工作机制。在<strong>编译之前</strong>，先由预处理器检查程序，根据程序中使用的预处理器指令，使用符号缩略语所代表的内容替换程序中的缩略语。</p>
<h2 id="预处理之前的翻译"><a href="#预处理之前的翻译" class="headerlink" title="预处理之前的翻译"></a>预处理之前的翻译</h2><p>在程序预处理之前，编译器会先做几次翻译处理。编译器先把源代码中出现的字符映射到源字符集。该过程处理多字节字符和使C外观更加国际化的三元字符的扩展。（这是因为有的键盘不能提供C使用的所有符号，所以C是哟娜个一组三字符序列为一些符号提供可选的表示方法，比如使用 <code>??=</code> 表示 <code>#</code>，C99提供了一种二元字符来代替三元字符）。C源码中出现这类三元字符时要先进行替换。<br>
          <div class="post-more-link text-center">
            <a class="btn" href="/c-preprocessor/" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/using-pointer-as-parameter/" itemprop="url">
                  C中使用指针作为参数的一些问题
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2015-12-08T12:34:50+08:00" content="2015-12-08">
              2015-12-08
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Programming/" itemprop="url" rel="index">
                    <span itemprop="name">Programming</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>这个问题其实比较常见了，但是经常会出错，就是C中函数的参数是值传递的，即使对于指针，也是值传递。很多高级语言在这一点是相通的。</p>
<p>今天看到这个问题是在 c-fqa.com 上的一个问题，看下面的代码：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">void f(int *ip) &#123;</span><br><span class="line">	static int dummy = 5;	// static make dummy accessiable for whole file</span><br><span class="line">	ip = &amp;dummy;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int *ip;</span><br><span class="line">f(ip);</span><br></pre></td></tr></table></figure>
<p>这时候ip指向哪里呢？实际上ip可能指向任何地址。因为ip没有初始化，传递给f函数调用的参数只是指针值的<strong>拷贝</strong>，对拷贝的修改并不会改变 ip 本身的内容。要达到本来的目的，需要传入 ip的地址，也就是指针的指针作为参数：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">void f(int **ipp) &#123;</span><br><span class="line">	static int dummy = 5;	// if no static here, then ip can be anywhere, *ip can be any value</span><br><span class="line">	*ip = &amp;dummy;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int  *ip;</span><br><span class="line">f(&amp;ip);</span><br></pre></td></tr></table></figure>
<p>另一种方法是把结果的指针作为函数的返回值，这是更常用的方式：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">int *f() &#123;</span><br><span class="line">	static int dummy = 5;</span><br><span class="line">	return &amp;dummy;</span><br><span class="line">&#125;</span><br><span class="line">int *ip = f();</span><br></pre></td></tr></table></figure>
<p>另一个例子是，定制一个 malloc 的自己的版本：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">void mymalloc(void *retp, size_t size) &#123;</span><br><span class="line">	retp = malloc(size);</span><br><span class="line">	if (retp == NULL) &#123;</span><br><span class="line">		fprintf(stderr, &quot;out of memory\n&quot;);</span><br><span class="line">		exit(EXIT_FAILURE);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>看起来没有什么问题，但是在调用这个函数时并不能正常工作，因为被调用函数接受的指针是调用者传入的指针的拷贝。</p>
<blockquote>
<p>C always uses pass by value. You can simulate pass by reference yourself, by defining functions which accept pointers and then using the &amp; operator when calling, and the compiler will essentially simulate it for you when you pass an array to a function </p>
</blockquote>
<p>这些内容在Java和Go中也是通用的，指针作为参数实际上也是值传递的哦。</p>
<p>参考：</p>
<ul>
<li><a href="http://c-faq.com/ptrs/passbyref.html" target="_blank" rel="noopener">http://c-faq.com/ptrs/passptrinit.html</a></li>
<li><a href="http://c-faq.com/ptrs/passbyref.html" target="_blank" rel="noopener">http://c-faq.com/ptrs/passbyref.html</a></li>
</ul>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    

  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/8/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span><a class="page-number" href="/page/10/">10</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/10/"><i class="fa fa-angle-right"></i></a>
  </nav>



        </div>

        


        

      </div>

      
        
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" src="/images/avatar.jpg" alt="wuxu" itemprop="image"/>
          <p class="site-author-name" itemprop="name">wuxu</p>
        </div>
        <p class="site-description motion-element" itemprop="description">Wu Xu的个人博客</p>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">176</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            <a href="/categories">
              <span class="site-state-item-count">24</span>
              <span class="site-state-item-name">分类</span>
              </a>
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">147</span>
              <span class="site-state-item-name">标签</span>
              </a>
          </div>

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/wuxu92" target="_blank">
                  
                    <i class="fa fa-github"></i> GitHub
                  
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/wuxu92" target="_blank">
                  
                    <i class="fa fa-twitter"></i> Twitter
                  
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/kiwidock" target="_blank">
                  
                    <i class="fa fa-weibo"></i> Weibo
                  
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://douban.com/people/wuxu92" target="_blank">
                  
                    <i class="fa fa-douban"></i> Douban
                  
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.zhihu.com/people/wuxu92" target="_blank">
                  
                    <i class="fa fa-zhihu"></i> Zhihu
                  
                </a>
              </span>
            
          
        </div>

        
        
          <div class="cc-license motion-element" itemprop="license">
            <a href="http://creativecommons.org/licenses/by-nc-sa/4.0" class="cc-opacity" target="_blank">
              <img src="/images/cc-by-nc-sa.svg" alt="Creative Commons" />
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


      
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2014 - 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="icon-next-heart fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">wuxu</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  

  
    
    

  


  

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.5.2"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.5.2"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
<script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

<script type="text/javascript" src="/js/motion.js?v=0.4.5.2" id="motion.global"></script>


  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  

  <script type="text/javascript" src="/js/bootstrap.js"></script>

  
  

  
  

</body>
</html>
